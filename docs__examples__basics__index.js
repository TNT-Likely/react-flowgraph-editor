(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{D4mU:function(e,t,a){"use strict";a.r(t);var i=a("ODXe"),r=a("q1tI"),o=a.n(r),n=a("VTBJ"),s=a("MNGV"),d=a.n(s),h={DragNode:"drag-node",DragCanvas:"drag-canvas",CreateEdge:"create-edge",ClickSelect:"click-select",BrushSelect:"brush-select",DragAddNode:"drag-add-node",DragAddEdge:"drag-add-edge",DragMoveEdge:"drag-move-edge",HoverItem:"hover-item",ClickItem:"click-item",RecallEdge:"recall-edge",DragResizeNode:"drag-resize-node",MoveNode:"move-node",DragCombo:"drag-combo",ShortCuts:"short-cuts",MovePolyline:"move-polyline"},l=[h.DragAddEdge,h.DragMoveEdge,h.HoverItem,h.ClickItem,h.DragResizeNode,h.MoveNode,h.DragCombo,h.ShortCuts,h.ClickSelect,{type:h.BrushSelect,trigger:"drag"},h.MovePolyline],c={onBeforeAddItem:"beforeadditem",onAfterAddItem:"afteradditem",onBeforeRemoveItem:"beforeremoveitem",onAfterRemoveItem:"afterremoveitem",onBeforeUpdateItem:"beforeupdateitem",onAfterUpdateItem:"afterupdateitem",onBeforeItemVisibilityChange:"beforeitemvisibilitychange",onAfterItemVisibilityChange:"afteritemvisibilitychange",onBeforeItemStateChange:"beforeitemstatechange",onAfterItemStateChange:"afteritemstatechange",onBeforeRefreshItem:"beforerefreshitem",onAfterRefreshItem:"afterrefreshitem",onBeforeItemStatesClear:"beforeitemstatesclear",onAfterItemStatesClear:"afteritemstatesclear",onBeforeLayout:"beforelayout",onAfterLayout:"afterlayout",onAfterConnect:"afterconnect",onStackChange:"stackchange",onNodeselectchange:"nodeselectchange"},g={Node:"node",Edge:"edge",Combo:"combo",Group:"group"},p={Circle:"circle",Rect:"rect",Ellipse:"ellipse",Diamond:"diamond",Triangle:"triangle",Star:"star",Image:"image",ModelRect:"modelRect",FlowBase:"flowBase",FlowRect:"flowRect",FlowRoundRect:"flowRoundRect",FlowCircle:"flowCircle",FlowDiamond:"flowDiamond"},v={Circle:"circle",Rect:"rect",Ellipse:"ellipse",Polygon:"polygon",Fan:"fan",Image:"image",Marker:"marker",Path:"path",Text:"text"},u={Line:"line",Polyline:"polyline",Arc:"arc",Quadratic:"quadartic",Cubic:"cubic",CubucVertical:"cubic-vertical",CUbicHorizontal:"cubic-horizontal",Loop:"loop",FlowEdge:"flow-edge"},m={Rect:"rect",Circle:"circle",FlowCombo:"flow-combo"},f="node-wrapper",y="node-label",b=10,x="flow-edge-start-placeholder",S="flow-edge-end-placeholder",w="edge-shape-dragline",C="draglineIndex",E="anchorPoint",M="controlPoint",O={Enabled:"enabled",Disabled:"disabled"},k={Backspace:8,Control:17,C:67,V:86,Y:89,Z:90,NumberAdd:107,Add:187,Minus:189,NumberMinus:109,Zero:48,NumberZero:96},N={Add:"add",Update:"update",Delete:"delete"},A={Active:"active",ActiveAnchorPoints:"activeAnchorPoints",Selected:"selected",HighLight:"highLight",Error:"error"},D="flow-editor",I=a("uFwe"),B=document.createElement("canvas"),j=B.getContext("2d");function P(e,t,a,i){if(j){if(j.font=t,j.measureText(e).width<=i)return e;var r,o=[],n="",s=0,d=Object(I["a"])(e);try{for(d.s();!(r=d.n()).done;){var h=r.value,l=j.measureText(h),c=l.width;s+c>=i&&(o.push(n),n="",s=0),n+=h,s+=c}}catch(S){d.e(S)}finally{d.f()}if(n&&o.push(n),o.length>a){var g,p="...",v=j.measureText(p).width,u="",m=0,f=Object(I["a"])(o[a-1]);try{for(f.s();!(g=f.n()).done;){var y=g.value,b=j.measureText(y),x=b.width;if(m+x>i-v)break;u+=y,m+=x}}catch(S){f.e(S)}finally{f.f()}o=o.slice(0,a-1).concat("".concat(u).concat(p))}return o.join("\n")}}var z,L=e=>{var t=e.getUndoStack();if(t&&!(t.length<=1)){var a=t.pop();if(a){var i=a.action;e.pushStack(i,Object.assign({},a.data),"redo");var r=a.data.before;if("add"===i&&(r=a.data.after),!r)return;switch(i){case"update":Object.keys(r).forEach((t=>{var a=r[t];a&&a.forEach((t=>{e.updateItem(t.id||"",t,!1)}))}));break;case"delete":Object.keys(r).forEach((t=>{var a=r[t];a&&a.forEach((t=>{var a=t.itemType;e.addItem(a,t,!1)}))}));break;case"add":Object.keys(r).forEach((t=>{var a=r[t];a&&a.forEach((t=>{e.removeItem(t.id||"",!1)}))}));break}}}},F=e=>{var t=e.getRedoStack();if(t&&0!==t.length){var a=t.pop();if(a){var i=a.action,r=a.data.after;if(e.pushStack(i,Object.assign({},a.data)),"delete"===i&&(r=a.data.before),!r)return;switch(i){case"update":Object.keys(r).forEach((t=>{var a=r[t];a&&a.forEach((t=>{e.updateItem(t.id||"",t,!1)}))}));break;case"delete":r.edges&&r.edges.forEach((t=>{e.removeItem(t.id||"",!1)})),r.nodes&&r.nodes.forEach((t=>{e.removeItem(t.id||"",!1)})),r.combos&&r.combos.forEach((t=>{e.removeItem(t.id||"",!1)}));break;case"add":Object.keys(r).forEach((t=>{var a=r[t];a&&a.forEach((t=>{var a=t.itemType;e.addItem(a,t,!1)}))}));break;default:}}}},R=a("OBvo"),X=a.n(R),Y=a("/WcD"),T=a.n(Y),U="".concat(D,"-editable-label"),W=e=>{null===e||void 0===e||e.stopPropagation();var t=H().innerText;z&&z(t),J()},Z=e=>{e.stopPropagation(),13===e.keyCode&&W()},H=()=>{var e=Ze.graph,t=document.querySelector(".".concat(U));if(!t){var a=e.getContainer(),i=X()("<div class='".concat(U,"' contentEditable></div>"));return a.appendChild(i),i}return t},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=(Ze.ratio,Ze.graph.getContainer().getBoundingClientRect()),r=i.x,o=i.y;t.width=t.width+"px",t.height=t.height+"px",t.minWidth=t.minWidth+"px",t.minHeight=t.minHeight+"px",t.left=t.left+r+"px",t.top=t.top+o+"px";var s=H();window.requestAnimationFrame((()=>{if(z=a,s.innerHTML=e,document.addEventListener("click",W),s.addEventListener("click",(e=>e.stopPropagation())),s.addEventListener("blur",W),s.addEventListener("keydown",Z),window.getSelection){s.focus();var i=window.getSelection();null===i||void 0===i||i.selectAllChildren(s)}T()(s,Object(n["a"])(Object(n["a"])({},t),{},{visibility:"visible"}))}))},J=()=>{var e=H();document.removeEventListener("click",W),e.removeEventListener("blur",W),e.removeEventListener("keydown",Z),T()(e,{visibility:"hidden"})},V="x-line",_="y-line",G={lineWidth:1,stroke:"#fa3426",opacity:1},q=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le(),i=Ze.graph,r=i.getWidth(),o=i.getHeight(),s=i.getGroup(),d="x"===e,h=d?_:V,l=s.findById(a),c=()=>d?[["M",t,0],["L",t,o]]:[["M",0,t],["L",r,t]];l?l.attr(Object(n["a"])({path:c()},G)):s.addShape("path",{name:h,id:a,attrs:Object(n["a"])({path:c()},G)})},Q=e=>{var t=Ze.graph,a=t.getGroup(),i="x"===e?_:V,r=a.findAllByName(i);r.forEach((e=>{a.removeChild(e)}))},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Ze.graph,i=a.getGroup(),r=i.findById(e);r&&r.attr({opacity:t?1:0})},ee=(e,t,a,i,r)=>{var o={left:0,middle:.5,right:1},n="x"===r?0:1,s="x"===r?e.w:e.h,d=Ze.graph,h=t[a][n]-s*o[i],l={};l[r]=h,d.updateItem(e.id,l,!1)},te=e=>{var t=e.getModel(),a=t.x,i=void 0===a?0:a,r=t.y,o=void 0===r?0:r,n=t.size,s=t.id,d=0,h=0;return"number"===typeof n&&(d=n,h=n),Array.isArray(n)&&(d=n[0],h=n[1]),{id:s||"",x:i,y:o,w:d,h:h,left:[i,o],middle:[i+.5*d,o+.5*h],right:[i+d,o+h]}},ae=a("iTfj"),ie=e=>{var t=e.x,a=e.y;return{x:t,y:a,centerX:t,centerY:a,minX:t,minY:a,maxX:t,maxY:a,height:0,width:0}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],a=[];e.forEach((e=>{t.push(e.x),a.push(e.y)}));var i=Math.min.apply(Math,t),r=Math.max.apply(Math,t),o=Math.min.apply(Math,a),n=Math.max.apply(Math,a);return{centerX:(i+r)/2,centerY:(o+n)/2,maxX:r,maxY:n,minX:i,minY:o,height:n-o,width:r-i}},oe=(e,t)=>2*Math.abs(e.centerX-t.centerX)<e.width+t.width&&2*Math.abs(e.centerY-t.centerY)<e.height+t.height,ne=e=>{var t=[],a={};return e.forEach((e=>{var t="".concat(e.x,"-").concat(e.y);e.id=t,a[t]=e})),Object(ae["a"])(a,(e=>{t.push(e)})),t},se=e=>(e=ne(e),e),de=(e,t)=>[e,{x:e.x,y:t.y},t],he=(e,t)=>0===e.width&&0===e.height?e:{centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t},le=(e,t)=>{var a=Math.abs(e.x-t.centerX),i=Math.abs(e.y-t.centerY);return a/t.width>i/t.height},ce=(e,t)=>{var a=le(t,e);return a?{x:t.x>e.centerX?e.maxX:e.minX,y:t.y}:{x:t.x,y:t.y>e.centerY?e.maxY:e.minY}},ge=(e,t)=>{var a=Math.min(e.minX,t.minX),i=Math.min(e.minY,t.minY),r=Math.max(e.maxX,t.maxX),o=Math.max(e.maxY,t.maxY);return{centerX:(a+r)/2,centerY:(i+o)/2,minX:a,minY:i,maxX:r,maxY:o,height:o-i,width:r-a}},pe=e=>{var t=e.minX,a=e.minY,i=e.maxX,r=e.maxY;return[{x:t||0,y:a||0},{x:i||0,y:a||0},{x:i||0,y:r||0},{x:t||0,y:r||0}]},ve=(e,t)=>{var a=e.x,i=e.y;return a<(t.minX||0)||a>(t.maxX||0)||i<(t.minY||0)||i>(t.maxY||0)},ue=(e,t)=>t<(e.minX||0)||t>(e.maxX||0)?[]:[{x:t,y:e.minY||0},{x:t,y:e.maxY||0}],me=(e,t)=>t<(e.minY||0)||t>(e.maxY||0)?[]:[{x:e.minX||0,y:t},{x:e.maxX||0,y:t}],fe=(e,t)=>ue(e,t.x).concat(me(e,t.y)),ye=(e,t)=>Math.abs(e.x-t.x)+Math.abs(e.y-t.y),be=(e,t)=>{var a=-2,i=0;return t.forEach((t=>{t&&(e.x===t.x&&(i+=a),e.y===t.y&&(i+=a))})),i},xe=(e,t,a,i,r)=>ye(e,t)+ye(e,a)+be(e,[t,a,i,r]),Se=function e(t,a,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;t.unshift(a[r]),i[r]&&i[r]!==r&&o<=100&&e(t,a,i,i[r],o+1)},we=(e,t)=>{var a=e.indexOf(t);a>-1&&e.splice(a,1)},Ce=(e,t,a,i)=>{var r=t.x-e.x,o=t.y-e.y,n=i.x-a.x,s=i.y-a.y,d=(-o*(e.x-a.x)+r*(e.y-a.y))/(-n*o+r*s),h=(n*(e.y-a.y)-s*(e.x-a.x))/(-n*o+r*s);return d>=0&&d<=1&&h>=0&&h<=1},Ee=(e,t,a)=>{if(0===a.width&&0===a.height)return!1;var r=pe(a),o=Object(i["a"])(r,4),n=o[0],s=o[1],d=o[2],h=o[3];return Ce(e,t,n,s)||Ce(e,t,n,h)||Ce(e,t,s,d)||Ce(e,t,d,h)},Me=(e,t,a,i)=>{var r=[];return e.forEach((e=>{e!==t&&(e.x!==t.x&&e.y!==t.y||Ee(e,t,a)||Ee(e,t,i)||r.push(e))})),ne(r)},Oe=(e,t,a,i,r,o,n)=>{var s=[],d=[t],h={},l={},c={};l[t.id||""]=0,c[t.id||""]=xe(t,a,t);var g={};e.forEach((e=>{g[e.id||""]=e}));var p=function(){var p=void 0,v=1/0;if(d.forEach((e=>{c[e.id]<v&&(v=c[e.id],p=e)})),p===a){var u=[];return Se(u,g,h,a.id),{v:u}}we(d,p),s.push(p),Me(e,p,i,r).forEach((e=>{if(-1===s.indexOf(e)){-1===d.indexOf(e)&&d.push(e);var i=c[p.id]+ye(p,e);l[e.id||""]&&i>=l[e.id||""]||(h[e.id||""]=p.id,l[e.id||""]=i,c[e.id||""]=l[e.id||""]+xe(e,a,t,o,n))}}))};while(d.length){var v=p();if("object"===typeof v)return v.v}return[t,a]},ke=(e,t,a,i,r)=>{var o,n;if(a&&a.getType())if("combo"===a.getType()){var s=a.getKeyShape();o=s.getCanvasBBox()||ie(e),o.centerX=(o.minX||0+(o.maxX||0))/2,o.centerY=(o.minY||0+(o.maxY||0))/2}else o=a.getBBox();else o=ie(e);if(i&&i.getType())if("combo"===i.getType()){var d=i.getKeyShape();n=d.getCanvasBBox()||ie(t),n.centerX=(n.minX||0+(n.maxX||0))/2,n.centerY=(n.minY||0+(n.maxY||0))/2}else n=i&&i.getBBox();else n=ie(t);if(oe(o,n))return se(de(e,t));var h=he(o,r),l=he(n,r);if(oe(h,l))return se(de(e,t));var c=ce(h,e),g=ce(l,t),p=re([c,g]),v=(ge(h,l),ge(h,p)),u=ge(l,p),m=[];m=m.concat(pe(v)),m=m.concat(pe(u));var f={x:(e.x+t.x)/2,y:(e.y+t.y)/2};[p,v,u].forEach((e=>{m=m.concat(fe(e,f).filter((e=>ve(e,h)&&ve(e,l))))})),[{x:c.x,y:g.y},{x:g.x,y:c.y}].forEach((e=>{ve(e,h)&&ve(e,l)&&m.push(e)})),m.unshift(c),m.push(g),m=ne(m);var y=Oe(m,c,g,o,n,e,t);return y.unshift(e),y.push(t),y},Ne="".concat(D,"-tooltip"),Ae=()=>{var e=Ze.graph,t=document.querySelector(".".concat(Ne));if(!t){var a=e.getContainer(),i=X()("<div class='".concat(Ne,"'></div>"));return a.appendChild(i),i}return t},De=(e,t)=>{var a=Ze.ratio,i=t.getBBox(),r=i.x,o=i.y,n=i.width,s=i.height,d=Ze.graph.getContainer().getBoundingClientRect(),h=d.x,l=d.y,c={left:(r+n/2)*a-60+h+"px",top:(o+s+10)*a+l+"px",visibility:"visible"},g=Ae();window.requestAnimationFrame((()=>{g.innerHTML=e,T()(g,c)}))},Ie=()=>{var e=Ae();T()(e,{visibility:"hidden"})},Be=.05,je=()=>{var e=Ze.graph.getMaxZoom(),t=Ze.ratio,a=(100*t+100*Be)/100;Ze.changeZoom(a>e?e:a,!0)},Pe=()=>{var e=Ze.graph.getMinZoom(),t=Ze.ratio,a=(100*t-100*Be)/100;Ze.changeZoom(a<e?e:a,!0)},ze=()=>{Ze.changeZoom(1,!0)},Le=()=>"xxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,a="x"===e?t:3&t|8;return a.toString(16)})),Fe=(e,t)=>{var a=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return Math.sqrt(a*a+i*i)},Re=(e,t)=>{var a=e.get("autoPaint");e.setAutoPaint(!1),t(),e.paint(),e.setAutoPaint(a)},Xe=e=>e.findAllByState(g.Node,A.Selected),Ye=e=>e.findAllByState(g.Edge,A.Selected),Te=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0,a=Xe(e),i=Ye(e);Re(e,(()=>{[...a,...i].forEach((a=>{t(a)&&e.setItemState(a,A.Selected,!1)}))}))};var Ue=e=>{var t=e.getType(),a=Object(n["a"])(Object(n["a"])({},e.getModel()),{},{itemType:t});return a},We=e=>{e.getCombos().forEach((t=>{e.uncombo(t)}))},Ze={};class He extends r["PureComponent"]{constructor(e){var t;super(e),t=this,this.graph={},this.containerId=Le(),this.copyData={nodes:new Set,edges:new Set},this.state={editable:this.props.editable},this.initGraph=()=>{var e=this.props,t=(e.behaviors,e.width),a=e.height,i=e.data,r=e.ratio,o=void 0===r?1:r,n=e.grid,s=void 0!==n&&n,h=this.containerId,g=[];s&&g.push(new d.a.Grid);var v=new d.a.Graph({container:h,width:t,height:a,enabledStack:!0,maxZoom:1,modes:{default:[...l]},defaultNode:{type:p.FlowRect},defaultEdge:{type:u.FlowEdge},defaultCombo:{type:m.FlowCombo},plugins:[...g]});v.data(i),v.render(),v.on(c.onStackChange,this.handleStackChange),v.on(c.onNodeselectchange,this.handleSelectedChange),Ze.graph=this.graph=v,this.changeZoom(o)},this.shouldChangeSize=e=>{var t=this.props,a=t.width,i=t.height;return e.width!==a||e.height!==i},this.changeSize=(e,t)=>{this.graph.changeSize(e,t)},this.shouldZoom=e=>e.ratio!==this.props.ratio,this.changeZoom=(e,t)=>{var a=this.props.onRatioChange;Ze.ratio=e,this.graph.zoomTo(e),t&&a&&a(e)},this.shouldChangeData=e=>JSON.stringify(e.data)!==JSON.stringify(this.props.data),this.shouldChangeEditable=e=>e.editable!==this.props.editable,this.addNode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.FlowRect,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t.graph.addItem(g.Node,Object(n["a"])({id:Le(),type:e,x:a,y:i},o),r)},this.moveNode=(e,t,a)=>{var i;null===(i=this.graph)||void 0===i||i.updateItem(e,{x:t,y:a},!1)},this.getClientRect=()=>this.graph.getContainer().getBoundingClientRect(),this.toggleEditable=e=>{var t=this.state.editable,a=void 0!==e?e:!t;return new Promise((e=>{this.setState({editable:a},(()=>{Ze.editable=a}))}))},this.getData=()=>{var e;return null===(e=this.graph)||void 0===e?void 0:e.save()},this.changeData=e=>{var t;null===(t=this.graph)||void 0===t||t.changeData(e,!1)},this.calculatePosition=(e,t)=>{var a=this.getClientRect(),i=a.x,r=a.y,o=Ze.ratio;return{x:(e-i)/o,y:(t-r)/o}},this.canUndo=()=>!!this.graph.getUndoStack().length,this.canRedo=()=>!!this.graph.getRedoStack().length,this.undo=()=>{L(this.graph)},this.redo=()=>{F(this.graph)},this.handleStackChange=()=>{var e=this.props.onStackChange,t=this.graph.getStackData(),a=t.undoStack,i=t.redoStack;e&&e({canUndo:a.length>1,canRedo:i.length>0})},this.getStackData=e=>{var t=e.getType(),a=Object(n["a"])(Object(n["a"])({},e.getModel()),{},{itemType:t});return a},this.findSelected=()=>{var e=this.graph,t=e.findAllByState(g.Edge,A.Selected).map((e=>e.getID())),a=[...e.findAllByState(g.Node,A.Selected),...e.findAllByState(g.Combo,A.Selected)].map((e=>e.getID()));return a.forEach((a=>{var i=e.findById(a).getEdges();i.forEach((e=>{t.push(e.getID())}))})),{nodes:new Set(a),edges:new Set(t)}},this.bulkUpdate=(e,t)=>{var a=this.graph,i=e.nodes,r=e.edges,o={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}},s="-".concat(Math.floor(1e3*Math.random())),d=50,h=t===N.Add?[...i,...r]:[...r,...i];h.forEach((e=>{var i=a.findById(e),r=this.getStackData(i),h=i.getType();switch(t){case N.Delete:o.before["".concat(h,"s")].push(r),a.removeItem(i,!1);break;case N.Add:r.id+=s,h===g.Edge?(r.source+=s,r.target+=s):h===g.Node&&(r.x=(r.x||0)+d,r.y=(r.y||0)+d),o.after["".concat(h,"s")].push(Object(n["a"])(Object(n["a"])({},r),{},{sourceNode:void 0,targetNode:void 0})),a.addItem(h,r,!1);break}})),h.length&&a.pushStack(t,o)},this.deleteSelected=()=>{var e=this.findSelected();this.bulkUpdate(e,N.Delete)},this.copy=()=>{this.copyData=this.findSelected()},this.paste=()=>{var e=this.copyData;this.bulkUpdate(e,N.Add)},this.handleSelectedChange=()=>{},Ze.editable=e.editable,Ze.addNode=this.addNode.bind(this),Ze.moveNode=this.moveNode.bind(this),Ze.getData=this.getData.bind(this),Ze.changeData=this.changeData.bind(this),Ze.calculatePosition=this.calculatePosition.bind(this),Ze.changeZoom=this.changeZoom.bind(this),Ze.undo=this.undo.bind(this),Ze.redo=this.redo.bind(this),Ze.deleteSelected=this.deleteSelected.bind(this),Ze.copy=this.copy.bind(this),Ze.paste=this.paste.bind(this)}componentDidMount(){this.initGraph()}componentDidUpdate(e){this.shouldChangeSize(e)&&this.changeSize(this.props.width,this.props.height),this.shouldZoom(e)&&this.changeZoom(this.props.ratio||1),this.shouldChangeData(e)&&this.changeData(this.props.data),this.shouldChangeEditable(e)&&this.toggleEditable(this.props.editable||!1)}componentWillUnmount(){this.graph.destroy()}render(){var e=this.props.style,t=this.state.editable,a=this.containerId;return o.a.createElement("div",{id:a,className:D,style:Object(n["a"])(Object(n["a"])({},e),{},{pointerEvents:t?"all":"none"})})}}He.defaultProps={width:1200,height:600,ratio:1,editable:!0,behaviors:[]};var Ke=He,Je=a("QkVN"),Ve=a.n(Je),_e=a("Z0cm"),Ge=a.n(_e),qe=(e,t)=>{var a=e.getModel(),r=a.size,o=Object(i["a"])(r,2),n=o[0],s=o[1],d=Object(i["a"])(t,2),h=d[0],l=d[1];return{x:n*h,y:s*l,r:4,lineWidth:1,fill:"#FFFFFF",stroke:"#5AAAFF",cursor:"crosshair"}};function Qe(e,t){var a=t.getContainer(),i=t.getModel(),r=e.getAnchorPoints(i)||[],o=a.findAllByName(E);r.forEach(((e,i)=>{o.length?o[i].attr(Object(n["a"])({},qe(t,e))):a.addShape("circle",{name:E,attrs:Object(n["a"])({},qe(t,e)),isAnchorPoint:!0,anchorPointIndex:i,anchorPointState:O.Enabled})}))}var $e=e=>{var t=e.getContainer(),a=t.findAllByName(E);a.forEach((e=>{t.removeChild(e)}))},et=[[0,0],[0,1],[1,0],[1,1]],tt=e=>{var t=e.getContainer(),a=t.findAllByName(M);a.length||et.forEach(((e,a)=>{t.addShape("rect",{name:M,point:e,attrs:{width:8,height:8,lineWidth:1,fill:"#FFFFFF",stroke:"#5AAAFF",cursor:[0,3].includes(a)?"nwse-resize":"nesw-resize"}})})),at(e)},at=e=>{var t=e.getContainer(),a=e.getModel(),r=a.size,o=Object(i["a"])(r,2),n=o[0],s=o[1],d=t.findAllByName(M);et.forEach(((e,t)=>{var a=Object(i["a"])(e,2),r=a[0],o=a[1];d[t].attr({x:n*r-4,y:s*o-4})}))},it=e=>{var t=e.getContainer(),a=t.findAllByName(M);a.forEach((e=>{t.removeChild(e)}))},rt={options:{wrapperStyle:{fill:"#fff",lineWidth:2,stroke:"#5487ea"},labelStyle:{fontSize:14,lineHeight:14,fill:"#000000",textAlign:"center",textBaseline:"middle"},stateStyles:{[A.Active]:{wrapperStyle:{},contentStyle:{},labelStyle:{}},[A.Selected]:{wrapperStyle:{},contentStyle:{},labelStyle:{}}}},getOptions(e){return Ve()({},this.options,this.getCustomConfig()||{},e)},draw(e,t){e.size=this.getSize(e);var a=this.drawWrapper(e,t);return this.drawLabel(e,t),a},setLabelText(e,t){var a=t.findByClassName(y);if(a){var r=this.getSize(e),o=Object(i["a"])(r,1),n=o[0],s=void 0===n?0:n,d=a.attr(),h=d.fontStyle,l=d.fontWeight,c=d.fontSize,g=d.fontFamily,p=e.label||"",v="".concat(h," ").concat(l," ").concat(c,"px ").concat(g);a.attr("text",P(p,v,2,s-2*b))}},update(e,t){var a=t.getContainer();this.setLabelText(e,a),this.updateLabel(e,a),this.updateWrapper(e,a)},setState(e,t,a){var i=a.getContainer(),r=a.getModel(),o=a.getStates()||[f,y].forEach((e=>{var t=i.findByClassName(e),a=this.getOptions(r),s=e.split("-")[1];t.attr(Object(n["a"])({},a["".concat(s,"Style")])),o.forEach((e=>{a.stateStyles[e]&&a.stateStyles[e]["".concat(s,"Style")]&&t.attr(Object(n["a"])({},a.stateStyles[e]["".concat(s,"Style")]))}))}));e===A.Selected&&(t?tt(a):it(a)),a.hasState(A.ActiveAnchorPoints)||a.hasState(A.Selected)?Qe(this,a):$e(a),this.afterSetState&&this.afterSetState(e,t,a)},afterSetState(e,t,a){},getSize(e){var t=this.getOptions(e),a=t.size;return a?Ge()(a)?a:[a,a]:a},getCustomConfig(){return{}},getAnchorPoints(){return[[.5,0],[1,.5],[.5,1],[0,.5]]}};d.a.registerNode(p.FlowBase,rt);var ot={drawWrapper(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=this.getOptions(e),h=d.wrapperStyle,l=t.addShape("rect",{className:f,draggable:!0,attrs:Object(n["a"])({x:0,y:0,width:o,height:s},h)});return l},drawLabel(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=this.getOptions(e),h=d.labelStyle,l=t.addShape("text",{className:y,draggable:!0,attrs:Object(n["a"])({x:o/2,y:s/2,text:e.label||""},h)});return l},updateLabel(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=t.findByClassName(y),h=this.getOptions(e),l=h.labelStyle;d.attr(Object(n["a"])(Object(n["a"])({},l),{},{x:o/2,y:s/2}))},updateWrapper(e,t){var a=t.findByClassName(f),r=this.getSize(e),o=Object(i["a"])(r,2),s=o[0],d=o[1],h=this.getOptions(e),l=h.wrapperStyle;a.attr(Object(n["a"])(Object(n["a"])({},l),{},{width:s,height:d}))},getCustomConfig(){return{size:[120,60]}}};d.a.registerNode(p.FlowRect,ot,p.FlowBase);var nt={getCustomConfig(){return{size:[120,60],wrapperStyle:{radius:8}}}};d.a.registerNode(p.FlowRoundRect,nt,p.FlowRect);var st={drawWrapper(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=this.getOptions(e),h=d.wrapperStyle,l=t.addShape(p.Ellipse,{className:f,draggable:!0,attrs:Object(n["a"])({x:o/2,y:s/2,rx:o/2,ry:s/2},h)});return l},drawLabel(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=this.getOptions(e),h=d.labelStyle,l=t.addShape("text",{className:y,draggable:!0,attrs:Object(n["a"])({x:o/2,y:s/2,text:e.label||""},h)});return l},updateWrapper(e,t){var a=t.findByClassName(f),r=this.getSize(e),o=Object(i["a"])(r,2),s=o[0],d=o[1],h=this.getOptions(e),l=h.wrapperStyle;a.attr(Object(n["a"])(Object(n["a"])({},l),{},{x:s/2,y:d/2,rx:s/2,ry:d/2}))},updateLabel(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=t.findByClassName(y),h=this.getOptions(e),l=h.labelStyle;d.attr(Object(n["a"])(Object(n["a"])({},l),{},{x:o/2,y:s/2}))},getCustomConfig(){return{size:[120,120]}}};d.a.registerNode(p.FlowCircle,st,p.FlowBase);var dt={drawWrapper(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=this.getOptions(e),h=d.wrapperStyle,l=t.addShape(v.Polygon,{className:f,draggable:!0,attrs:Object(n["a"])({points:[[0,s/2],[o/2,0],[o,s/2],[o/2,s]]},h)});return l},drawLabel(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=this.getOptions(e),h=d.labelStyle,l=t.addShape("text",{className:y,draggable:!0,attrs:Object(n["a"])({x:o/2,y:s/2,text:e.label||""},h)});return l},updateWrapper(e,t){var a=t.findByClassName(f),r=this.getSize(e),o=Object(i["a"])(r,2),s=o[0],d=o[1],h=this.getOptions(e),l=h.wrapperStyle;a.attr(Object(n["a"])(Object(n["a"])({},l),{},{points:[[0,d/2],[s/2,0],[s,d/2],[s/2,d]]}))},updateLabel(e,t){var a=this.getSize(e),r=Object(i["a"])(a,2),o=r[0],s=r[1],d=t.findByClassName(y),h=this.getOptions(e),l=h.labelStyle;d.attr(Object(n["a"])(Object(n["a"])({},l),{},{x:o/2,y:s/2}))},getCustomConfig(){return{size:[120,120]}}};d.a.registerNode(p.FlowDiamond,dt,p.FlowBase);var ht=24,lt={width:ht,height:ht,lineWidth:1,stroke:"#5AAAFF",fill:"#fff",cursor:"move",opacity:0},ct=2,gt="edge-shape",pt={lineWidth:2,stroke:"#fa3246",lineAppendWidth:5,opacity:0},vt={options:{style:{stroke:"#ccc1d8",lineAppendWidth:5,lineWidth:2,shadowColor:null,shadowBlur:4,radius:8,offset:24,endArrow:{path:"M 0,0 L 4,3 L 4,-3 Z"},cursor:"pointer"},labelCfg:{style:{fill:"#000000",fontSize:14,lineHeight:14,cursor:"pointer",background:{padding:[0,0,0,0],fill:"#fff"}}},routeCfg:{},stateStyles:{[A.Selected]:{stroke:"#5aaaff",shadowColor:"#5aaaff",shadowBlur:24},[A.HighLight]:{stroke:"#5aaaff",shadowColor:"#5aaaff",shadowBlur:24}}},getPath(e,t,a,i,r){if(this.cfg.nowPath)return this.cfg.nowPath;var o=30,n=ke(e[0],e[1],t,a,o),s=[];return n.forEach(((e,t)=>{0===t?s.push(["M",e.x,e.y]):s.push(["L",e.x,e.y])})),s},drawShape(e,t){this.cfg=e;var a=this.getShapeStyle(e);e.path&&(a.path=e.path);var i=t.addShape("path",{className:gt,name:gt,attrs:a});return i},update(e,t){this.cfg=e;var a=t.getKeyShape();a._calculateCurve(),a._setTcache(),this.updateShapeStyle(e,t),this.updateLabel(e,t)},afterDraw(e,t){this.drawPlaceholder(e,t),this.drawDragLine(e,t)},afterUpdate(e,t){var a=t.getContainer();this.drawPlaceholder(e,a),this.drawDragLine(e,a)},drawDragLine(e,t){for(var a=t.find((e=>"edge-shape"===e.get("className"))),i=a.attr("path").map((e=>({x:e[1],y:e[2]}))),r=[],o=1;o<i.length-1;o++){var s=i[o-1],d=i[o],h=i[o+1];d.x===s.x&&d.x===h.x||d.y===s.y&&d.y===h.y||r.push(Object(n["a"])(Object(n["a"])({},d),{},{index:o}))}this.removeUnnecessaryLine(r,t);for(var l=1;l<r.length;l++)this.drawSingleLine(r[l-1],r[l],e.id,t)},removeUnnecessaryLine(e,t){var a=t.findAllByName(w),i=e.length;a.forEach(((e,a)=>{a>i-2&&t.removeChild(e)}))},removeDragLine(e){var t=e.findAllByName(w);t.forEach((t=>e.removeChild(t)))},drawSingleLine(e,t,a,i){var r=e.index,o="drag_line_".concat(a,"_").concat(r,"_").concat(r+1),s=i.findById(o),d=()=>[["M",e.x,e.y],["L",t.x,t.y]],h=()=>Object(n["a"])(Object(n["a"])({},pt),{},{cursor:e.x===t.x?"ew-resize":"ns-resize"});s?s.attr(Object(n["a"])({path:d()},h())):i.addShape("path",{name:w,id:o,attrs:Object(n["a"])({path:d()},h())}).set(C,r)},drawPlaceholder(e,t){var a=t.findAllByName(x)[0],i=t.findAllByName(S)[0];if(!a){var r=t.addShape("rect",{name:x,attrs:Object(n["a"])({},lt)});r.set("zIndex",ct)}if(!i){var o=t.addShape("rect",{name:S,attrs:Object(n["a"])({},lt)});o.set("zIndex",ct)}t.sort(),this.updatePlaceholder(e,t)},updatePlaceholder(e,t){var a=e.startPoint,i=e.endPoint,r=t.findAllByName(x)[0],o=t.findAllByName(S)[0];r&&r.attr({x:((null===a||void 0===a?void 0:a.x)||0)-.5*ht,y:((null===a||void 0===a?void 0:a.y)||0)-.5*ht}),o&&o.attr({x:((null===i||void 0===i?void 0:i.x)||0)-.5*ht,y:((null===i||void 0===i?void 0:i.y)||0)-.5*ht})},setState(e,t,a){var i=a.get("keyShape");if(i){var r=this.options,o=r.style,s=r.stateStyles,d=s[e];d&&(t?i.attr(Object(n["a"])(Object(n["a"])({},o),d)):i.attr(o))}}};d.a.registerEdge(u.FlowEdge,vt,u.Polyline),d.a.registerCombo(m.FlowCombo,{options:{padding:[0,0,0,0],style:{lineWidth:2,stroke:"#fa3246"}}},m.Rect);var ut=a("YO3V"),mt=a.n(ut),ft="anchor_box",yt={lineWidth:1,fill:"#ff8406",r:16,opacity:.2},bt=10;class xt{constructor(){this.graph={},this.group={},this.points=[]}start(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";this.graph=e,this.group=e.getGroup(),this.points=e.getNodes().filter((e=>e.getID()!==t)).reduce(((e,t)=>{var a=t.getAnchorPoints().map((e=>Object(n["a"])(Object(n["a"])({},e),{},{id:t.getID()})));return e.concat(...a)}),[])}move(e,t){var a=this.points.find((a=>{var i=Fe(a,{x:e,y:t});return i<bt?(this.drawBox(a),!0):(this.hideBox(a),!1)}));return a}end(){var e=this.group.findAllByName(ft);e.forEach((e=>{this.group.removeChild(e)}))}getIdByPoint(e){return"".concat(e.id,"_").concat(e.index)}getShapeByPoint(e){return this.group.findById(this.getIdByPoint(e))}drawBox(e){var t=this.group,a=this.getIdByPoint(e),i=t.findById(a),r=Object(n["a"])(Object(n["a"])({},e),yt);i?i.attr(r):t.addShape("circle",{name:ft,id:a,attrs:r})}hideBox(e){var t=this.getShapeByPoint(e);t&&t.attr({opacity:0})}}var St=xt,wt=new St,Ct={edge:null,graphType:"flow",getDefaultCfg(){return{edgeType:u.FlowEdge,getAnchorPointStateOfSourceNode:()=>O.Enabled,getAnchorPointStateOfTargetNode:()=>O.Enabled}},getEvents(){return{"node:mouseenter":"handleNodeMouseEnter","node:mouseleave":"handleNodeMouseLeave","node:mousedown":"handleNodeMouseDown",mousemove:"handleMouseMove",mouseup:"handleMouseUp"}},isEnabledAnchorPoint(e){var t=e.target;return!!t.get("isAnchorPoint")&&t.get("anchorPointState")===O.Enabled},isNotSelf(e){var t=this.edge,a=e.item;return a.getModel().id!==t.getSource().getModel().id},getTargetNodes(e){var t=this.graph,a=t.getNodes();return a.filter((t=>t.getModel().id!==e))},canFindTargetAnchorPoint(e){return this.isEnabledAnchorPoint(e)&&this.isNotSelf(e)},shouldAddDelegateEdge(e){return this.isEnabledAnchorPoint(e)},shouldAddRealEdge(){var e=this.edge,t=e.getTarget();return!mt()(t)},handleNodeMouseEnter(e){var t=this.graph,a=this.getAnchorPointStateOfSourceNode,i=e.item,r=i.getAnchorPoints(),o=[];r.forEach((e=>{o.push(a(i,e))})),i.set("anchorPointsState",o),t.setItemState(i,A.ActiveAnchorPoints,!0)},handleNodeMouseLeave(e){var t=this.graph,a=this.edge,i=e.item;a||(i.set("anchorPointsState",[]),t.setItemState(i,A.ActiveAnchorPoints,!1))},handleNodeMouseDown(e){if(this.shouldBegin(e)&&this.shouldAddDelegateEdge(e)){var t=this.graph,a=this.edgeType,i=this.getAnchorPointStateOfTargetNode,r=e.target,o=e.item,n=o.getModel().id,s=r.get("anchorPointIndex"),d=o.getAnchorPoints()[s];wt.start(t,n);var h={id:Le(),type:a,source:n,sourceAnchor:s,target:{x:e.x,y:e.y}};this.edge=t.addItem(g.Edge,h,!1),t.getNodes().forEach((e=>{if(e.getModel().id!==n){var a=e.getAnchorPoints(),r=[];a.forEach((t=>{r.push(i(o,d,e,t))})),e.set("anchorPointsState",r),t.setItemState(e,A.ActiveAnchorPoints,!0)}}))}},handleMouseMove(e){var t=this.graph,a=this.edge;if(a){var i=wt.move(e.x,e.y);if(i){var r=i.id,o=i.index;t.updateItem(a,{target:r,targetAnchor:o},!1)}else t.updateItem(a,{target:{x:e.x,y:e.y},targetAnchor:void 0},!1)}},handleMouseUp(){var e=this.edge,t=this.graph;e&&(wt.end(),this.shouldAddRealEdge()?t.pushStack(N.Add,{before:{},after:{edges:[Ue(e)]}}):t.removeItem(this.edge,!1),this.edge=null,t.getNodes().forEach((e=>{e.set("anchorPointsState",[]),t.setItemState(e,A.ActiveAnchorPoints,!1)})))}};d.a.registerBehavior(h.DragAddEdge,Ct);var Et={graph:{},getEvents(){return{"node:mouseenter":"handleItemMouseenter","edge:mouseenter":"handleItemMouseenter","node:mouseleave":"handleItemMouseleave","edge:mouseleave":"handleItemMouseleave"}},handleItemMouseenter(e){if(e.item){var t=this.graph;t.setItemState(e.item,A.Active,!0)}},handleItemMouseleave(e){var t=this.graph;t.setItemState(e.item,A.Active,!1)}};d.a.registerBehavior(h.HoverItem,Et);var Mt={getDefaultCfg(){return{item:null,multiple:!0,keydown:!1,keyCode:17}},getEvents(){return{"edge:click":"handleItemClick","node:dblclick":"handleItemDbClick","edge:dblclick":"handleItemDbClick","canvas:click":"handleCanvasClick",keydown:"handleKeyDown",keyup:"handleKeyUp"}},handleItemClick(e){var t=e.item;if(t){this.item=t;var a=this.graph,i=null===t||void 0===t?void 0:t.hasState(A.Selected);this.multiple&&this.keydown?a.setItemState(t,A.Selected,!i):(Te(a,(e=>e!==t)),i||a.setItemState(t,A.Selected,!0))}},handleItemDbClick(e){var t=e.item;if(t){var a,i,r=this.graph,o=Ze.ratio,n=t.getContainer(),s=t.getModel(),d=s.label;if(t.getType()===g.Node){var h=t.getBBox(),l=h.width,c=h.height,p=h.x,v=h.y,u=20;a={width:(l-u)*o,minHeight:(c+u)*o,left:(p+.5*u)*o,top:(v-.5*u)*o}}else{var m=t.getKeyShape().getPoint(.5),f=m.x,y=m.y;i=n.findAllByName("text-bg-shape")[0];var b=20,x=10,S=20,w=i&&i.getBBox().width||b+S,C=x+S;a={minWidth:b+S,height:x+S,left:f*o-w/2,top:y*o-C/2}}var E="string"===typeof d?d:null===d||void 0===d?void 0:d.text;K(E,a,(e=>{r.updateItem(t,{label:e},d!==e)}))}},handleCanvasClick(e){var t=this.graph;this.item=null,We(t),Te(t)},handleKeyDown(e){this.keydown=(e.keyCode||e.which)===this.keyCode},handleKeyUp(){this.keydown=!1}};d.a.registerBehavior(h.ClickItem,Mt);var Ot={graph:{},attrs:{},item:{},isResize:!1,point:[],getDefaultCfg(){return{}},getEvents(){return{"node:mousedown":"handleNodeMouseDown",mousemove:"handleMouseMove",mouseup:"handleMouseUp"}},handleNodeMouseDown(e){var t=e.target,a=e.item;if(t){var i=t.get("name");i===M&&(this.isResize=!0,this.attrs=t.get("canvasBBox"),this.point=t.get("point"),this.item=a,this.itemModel=a.getBBox(),this.stackData=Ue(a))}},handleMouseMove(e){if(this.isResize){var t,a,i=this.point,r=this.attrs,o=this.item,s=this.itemModel,d=this.graph,h=r.x,l=r.y,c=s,g=c.width,v=c.height,u=c.x,m=c.y,f=e.canvasX,y=e.canvasY,b=o.getModel(),x=b.type,S=Ze.ratio,w=(f-h)*S,C=(y-l)*S;switch(x){case p.FlowCircle:t=[g+(i[0]||-1)*w,v+(i[1]||-1)*C],a={x:u+(i[0]-1)*w*-1,y:m+(i[1]-1)*C*-1};break;default:t=[g+(i[0]||-1)*w,v+(i[1]||-1)*C],a={x:u+(i[0]-1)*w*-1,y:m+(i[1]-1)*C*-1};break}d.updateItem(o,Object(n["a"])({size:t},a),!1),De("W: ".concat(parseInt(t[0]),"  H:").concat(parseInt(t[1])),o)}},handleMouseUp(){this.isResize&&(this.isResize=!1,Ie(),Ze.graph.pushStack(N.Update,{before:{nodes:[this.stackData]},after:{nodes:[Ue(this.item)]}}))}};d.a.registerBehavior(h.DragResizeNode,Ot);var kt=["left","middle","right"];class Nt{constructor(){this.nodeMaps=[]}start(e){var t=e.getNodes(),a=t.map(te);this.nodeMaps=a}move(e){var t=this.nodeMaps,a=e.getID(),i=te(e),r=t.filter((e=>e.id!==a));r.forEach((t=>{kt.forEach((a=>{this.checkLine(e,i,t,a,"x"),this.checkLine(e,i,t,a,"y")}))}))}end(){Q("x"),Q("y")}checkLine(e,t,a,i,r){var o="".concat(t.id,"_").concat(a.id,"_").concat(i,"_").concat(r),n=this.calcPosValuesSingle(i,e,a,r);if(n.near){var s=n.value;q(r,s,o),ee(t,a,i,n.type,r)}else $(o)}calcPosValuesSingle(e,t,a,i){var r=te(t),o="x"===i?0:1,n={near:!1,dist:-1,type:"",value:0},s=kt.map((t=>({type:t,dist:Math.abs(r[t][o]-a[e][o])}))).sort(((e,t)=>e.dist-t.dist))[0];return s.dist<5&&(n.dist=s.dist,n.near=!0,n.type=s.type,n.value=a[e][o]),n}}var At=Nt,Dt=new At,It={graph:{},draging:!1,nodes:[],edges:[],origin:{x:0,y:0},points:[],getEvents(){return{"node:dragstart":"handleNodeDragStart","node:drag":"handleNodeDrag","node:dragend":"handleNodeDragend"}},handleNodeDragStart(e){var t=e.item,a=e.target,i=e.x,r=e.y,o=this.graph;if(t&&!t.destroyed){var n=a.get("name");if(![E,M].includes(n)){if(!this.draging){o.setItemState(t,A.Selected,!0),this.draging=!0,this.origin={x:i,y:r},this.nodes=o.findAllByState(g.Node,A.Selected);var s=this.nodes.reduce(((e,t)=>(t.getEdges().forEach((t=>{e[t.getID()]=t})),e)),{});this.edges=Object.keys(s).map((e=>s[e])),this.points=this.nodes.reduce(((e,t)=>{var a=t.getModel();return e[a.id||""]={x:a.x,y:a.y},e}),{});var d={nodes:[],edges:[],combos:[]};this.nodes.forEach((e=>{d.nodes.push(Ue(e))})),this.edges.forEach((e=>{d.edges.push(Ue(e))})),this.beforeData=d,this.edges.forEach((e=>{o.updateItem(e,{nowPath:null},!1)}))}Dt.start(o)}}},handleNodeDrag(e){var t=e.item,a=e.x,i=e.y;if(this.draging&&t){var r=this.graph,o=this.origin,n=this.nodes,s=(this.edges,this.points),d=t.getID(),h=n.filter((e=>e.getID()!==d)),l=a-o.x,c=i-o.y;n.forEach((e=>{var t=e.getID(),a=s[t],i={x:a.x+l,y:a.y+c};r.updateItem(e,i,!1)})),h.length}De("X:".concat(Math.floor(a),"  Y:").concat(Math.floor(i)),t),1===this.nodes.length&&Dt.move(t)},handleNodeDragend(e){var t=e.item;if(this.draging&&t){var a=this.graph,i=this.beforeData,r={nodes:[],edges:[],combos:[]};this.nodes.forEach((e=>{r.nodes.push(Ue(e))})),this.edges.forEach((e=>{r.edges.push(Ue(e))}));var o={before:i,after:r};a.pushStack(N.Update,o),a.setItemState(t,A.Selected,!1),this.draging=!1,this.nodes=[],this.edges=[],this.points=[],this.beforeData=null}Ie(),Dt.end()}};d.a.registerBehavior(h.MoveNode,It);var Bt={isControl:!1,getEvents(){return{keydown:"handleKeyDown",keyup:"handleKeyUp"}},handleKeyDown(e){switch(e.preventDefault(),console.log(e.keyCode),e.keyCode){case k.Control:this.isControl=!0;break;case k.Z:this.isControl&&Ze.undo();break;case k.Y:this.isControl&&Ze.redo();break;case k.Backspace:Ze.deleteSelected();break;case k.C:this.isControl&&Ze.copy();break;case k.V:this.isControl&&Ze.paste();break;case k.Add:case k.NumberAdd:this.isControl&&je();break;case k.Minus:case k.NumberMinus:this.isControl&&Pe();break;case k.Zero:case k.NumberZero:this.isControl&&ze()}},handleKeyUp(e){switch(e.preventDefault(),e.keyCode){case k.Control:this.isControl=!1;break}}};d.a.registerBehavior(h.ShortCuts,Bt);var jt=new St,Pt={graph:{},edge:{},moving:"",getEvents(){return{"edge:mousedown":"handleEdgeMouseDown",mousemove:"handleMouseMove",mouseup:"handleMouseUp"}},handleMouseUp(){var e=this.graph,t=this.edge,a=this.beforeData,i=this.moving;if(i&&t){jt.end();var r=Ue(t),o={before:{edges:[a]},after:{edges:[r]}};JSON.stringify(a)!==JSON.stringify(r)&&e.pushStack(N.Update,o),this.moving="",this.edge=void 0,this.beforeData=null}},handleMouseMove(e){var t=e.x,a=e.y,i=(e.target,e.item,this.graph),r=this.edge,o=this.moving;if(o&&r){var n={},s=jt.move(t,a);if(s){var d=s.id,h=s.index;n[o]=d,n["".concat(o,"Anchor")]=h}else n[o]={x:t,y:a};n.nowPath=null,i.updateItem(r,n,!1)}},handleEdgeMouseDown(e){var t=e.target,a=e.item,i=this.graph,r=t.get("name"),o=[x,S],n=o.indexOf(r);if(!this.moving&&-1!==n&&a){this.edge=a,this.beforeData=Ue(a),this.moving=0===n?"source":"target";var s=a.get(0===n?"target":"source");jt.start(i,s)}}};d.a.registerBehavior(h.DragMoveEdge,Pt);var zt={graph:{},moving:!1,pathIndex:0,getEvents(){return{"edge:mousedown":"handleEdgeMouseDown",mousemove:"handleMouseMove",mouseup:"handleMouseUp"}},handleEdgeMouseDown(e){var t=e.target,a=e.item,i=t.get("name");if(i===w&&!this.moving){this.beforeData=JSON.stringify(Ue(a));var r=a.getKeyShape();this.moving=!0,this.edge=a,this.nowPath=r.attr("path"),this.pathIndex=t.get(C),this.isX="ew-resize"===t.attr("cursor")}},handleMouseMove(e){var t=e.x,a=e.y,i=this.edge,r=this.graph,o=this.nowPath,n=this.moving,s=this.pathIndex,d=this.isX;if(n&&i&&o){var h=d?1:2,l=d?t:a;o[s][h]=l,o[s+1][h]=l,r.updateItem(i,{nowPath:o},!1)}},handleMouseUp(){var e=this.graph,t=this.nowPath,a=this.beforeData;if(this.moving){var i=JSON.parse(a||"");if(JSON.stringify(i.nowPath)!==JSON.stringify(t)){var r={before:{edges:[Object(n["a"])({},i)]},after:{edges:[Object(n["a"])(Object(n["a"])({},i),{},{nowPath:t})]}};e.pushStack(N.Update,r)}this.moving=!1,this.edge=void 0,this.nowPath=void 0}}};d.a.registerBehavior(h.MovePolyline,zt);a("zSLb");var Lt=new At;class Ft extends o.a.PureComponent{constructor(e){super(e),this.node={},this.beforeData={},this.handleMouseDown=e=>{Ze.editable&&(this.beforeData=Ze.getData(),this.node=Ze.addNode(this.props.type),Lt.start(Ze.graph),this.handleMouseMove(e),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp))},this.handleMouseMove=e=>{var t=this.getPosition(e),a=t.x,i=t.y;Ze.moveNode(this.node,a,i),Lt.move(this.node)},this.handleMouseUp=()=>{var e=Ue(this.node);Ze.graph.pushStack(N.Add,{before:{},after:{nodes:[e]}}),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),Lt.end()},this.getPosition=e=>{var t=Ze.calculatePosition(e.clientX,e.clientY),a=t.x,i=t.y,r=this.node.getBBox(),o=r.width,n=r.height;return{x:a-.5*o,y:i-.5*n}}}componentDidMount(){}render(){var e=this.props,t=e.className,a=e.style,i=e.children;return o.a.createElement("div",{className:t,style:a,onMouseDown:this.handleMouseDown},i)}}var Rt=Ke,Xt=(a("sFfT"),{nodes:[{id:"111",label:"hello",x:100,y:100},{id:"222",label:"hello",x:300,y:300}],edges:[{source:"111",sourceAnchor:0,target:"222",targetAnchor:0}]});t["default"]=()=>{var e=Object(r["useState"])(!1),t=Object(i["a"])(e,2),a=t[0],n=t[1],s=Object(r["useState"])(!1),d=Object(i["a"])(s,2),h=d[0],l=d[1],c=Object(r["useState"])(1),g=Object(i["a"])(c,2),p=g[0],v=g[1],u=e=>{n(e.canUndo),l(e.canRedo)};return o.a.createElement("div",null,o.a.createElement("div",{className:"toolbar"},o.a.createElement("button",{disabled:!a},"\u64a4\u9500"),o.a.createElement("button",{disabled:!h},"\u6062\u590d"),"\u5f53\u524d\u7f29\u653e\u6bd4\u4f8b: ",100*p," %"),o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"dragitems"},o.a.createElement(Ft,null,"\u77e9\u5f62"),o.a.createElement(Ft,{type:"flowRoundRect"},"\u5706\u89d2\u77e9\u5f62"),o.a.createElement(Ft,{type:"flowCircle"},"\u5706\u5f62"),o.a.createElement(Ft,{type:"flowDiamond"},"\u83f1\u5f62")),o.a.createElement(Rt,{data:Xt,grid:!0,onStackChange:u,onRatioChange:e=>v(e)})))}},sFfT:function(e,t,a){},zSLb:function(e,t,a){}}]);